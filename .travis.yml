language: python

git:
  depth: false

os:
  - osx
    language: generic
  - linux

osx_image:
  - xcode9.3
  - xcode9.2
  - xcode9.1
  - xcode9
  - xcode8.3
  - xcode8
  - xcode7.3
  - xcode6.4

python:
  - 2.6
  - 2.7
  - 3.2
  - 3.3
  - 3.4
  - 3.5
  - 3.5-dev
  - 3.6
  - 3.6-dev
  - 3.7-dev
  - 3.8-dev
  - nightly
  - pypy
  - pypy2.7
  - pypy3
  - pypy3.5

sudo:
  - false

env:
  -
  - TOXENV=python@2
  - TOXENV=python@3

matrix:
  fast_finish: true
  allow_failures:
    - python: 3.5-dev
    - python: 3.6-dev
    - python: 3.7-dev
    - python: 3.8-dev
    - python: nightly
    - python: pypy2.7
    - python: pypy3.5
  exclude:
    - os: linux
      env: TOXENV=python@2
    - os: linux
      env: TOXENV=python@3

before_install:
  - |
    if [ "${TRAVIS_OS_NAME}" == 'osx' ]; then
        brew update >/dev/null
        case "${TOXENV}" in
            'python@2')
                brew install python2
                pip2 install pytest
                ;;
            'python@3')
                brew upgrade python
                pip3 install pytest
                ;;
        esac
    fi

install:
  -

script:
  - if [ "$(printf '%s\n' "${TRAVIS_PYTHON_VERSION}" | tr -d '.')" -le '35' ]; then
      py.test 'tests.py';
    else
      pytest 'tests.py';
    fi
